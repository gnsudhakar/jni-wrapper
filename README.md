# jni-wrapper
Java C++ Native sample codes
# Direct JNI Method
Interface Java C++ Native sample codes using JNI

The steps are as follows

1. Create Java class that includes “native” method sayHello()
```
public class HelloJNI {
    static {
        System.loadLibrary("hello");    // load libhello.so
    }

    private native void sayHello();

    public static void main(String[] args) {
        new HelloJNI().sayHello();
    }
}
```
2. Generate header file using Javac -h as follows:
```
 javac -h . HelloJNI.java
```
This will create a header file “HelloJNI.h” as follows
```
/* DO NOT EDIT THIS FILE - it is machine generated */
#include <jni.h>
/* Header for class HelloJNI */

#ifndef _Included_HelloJNI
#define _Included_HelloJNI
#ifdef __cplusplus
extern "C" {
#endif
/*
 * Class:     HelloJNI
 * Method:    sayHello
 * Signature: ()V
 */
JNIEXPORT void JNICALL Java_HelloJNI_sayHello
  (JNIEnv *, jobject);

#ifdef __cplusplus
}
#endif
#endif
```

3. Create CPP file based on generated header file . We have to implement the method by copying function
```
#include <iostream>
#include <jni.h>
#include "HelloJNI.h"   // auto-generated by `javah HelloJNI`

using namespace std;

JNIEXPORT void JNICALL Java_HelloJNI_sayHello (JNIEnv *, jobject) {
    cout << "Hello world. CPP" << endl;
    return;
}
```

4. Compile the CPP file using gcc commands:
Set Javapaths
MAC OS
```
export JAVA_HOME=`/usr/libexec/java_home`  
echo $JAVA_HOME/include 
g++ -shared -fPIC -I$JAVA_INC -I$JAVA_INC/darwin HelloC.cpp -o libhello.dylib
```
Linux OS:
```
 sudo su
 ls /usr/lib/jvm/
```
This will list the JAVA versions installed. Take required version as below
```
export JAVA_HOME="/usr/lib/jvm/java-8-openjdk-amd64/"
g++ -shared -fPIC -I$JAVA_INC -I$JAVA_INC/linux HelloC.cpp -o libhello.so
```
After this step you should have dynamic lib ( libhello.dylib or libhello.so) generated

Note:
As we have loaded the library as 
> System.loadLibrary("hello");    // load libhello.so

In HelloJNI.java , the function *sayHello()* will be resolved to **package_class_method()** as *Java_HelloJNI_sayHello()* in dynamic lib 

5. Let us run and  see the result
```
java -Djava.library.path=. HelloJNI   
```
![Screenshot 2022-03-09 at 4 58 16 PM](https://user-images.githubusercontent.com/56869062/157433250-4e1f2b48-5732-4a8b-b168-5e43c0942aa6.png)

# References

1. [ NTU Java Programming Tutorial](https://www3.ntu.edu.sg/home/ehchua/programming/java/javanativeinterface.html#zz-4.2)
